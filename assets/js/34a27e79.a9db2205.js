"use strict";(globalThis.webpackChunkfdm_monster_docs=globalThis.webpackChunkfdm_monster_docs||[]).push([[151],{1470(e,n,t){t.d(n,{A:()=>D});var r=t(6540),a=t(4164),s=t(7559),o=t(3104),i=t(6347),l=t(205),c=t(7485),d=t(1682),u=t(679);function h(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function m(e){const{values:n,children:t}=e;return(0,r.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:t,default:r}})=>({value:e,label:n,attributes:t,default:r}))}(t);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function p({value:e,tabValues:n}){return n.some(n=>n.value===e)}function f({queryString:e=!1,groupId:n}){const t=(0,i.W6)(),a=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(a),(0,r.useCallback)(e=>{if(!a)return;const n=new URLSearchParams(t.location.search);n.set(a,e),t.replace({...t.location,search:n.toString()})},[a,t])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:a}=e,s=m(e),[o,i]=(0,r.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:s})),[c,d]=f({queryString:t,groupId:a}),[h,g]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,a]=(0,u.Dv)(n);return[t,(0,r.useCallback)(e=>{n&&a.set(e)},[n,a])]}({groupId:a}),v=(()=>{const e=c??h;return p({value:e,tabValues:s})?e:null})();(0,l.A)(()=>{v&&i(v)},[v]);return{selectedValue:o,selectValue:(0,r.useCallback)(e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);i(e),d(e),g(e)},[d,g,s]),tabValues:s}}var v=t(2303);const x="tabList__CuJ",b="tabItem_LNqP";var k=t(4848);function w({className:e,block:n,selectedValue:t,selectValue:r,tabValues:s}){const i=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.a_)(),c=e=>{const n=e.currentTarget,a=i.indexOf(n),o=s[a].value;o!==t&&(l(n),r(o))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=i.indexOf(e.currentTarget)+1;n=i[t]??i[0];break}case"ArrowLeft":{const t=i.indexOf(e.currentTarget)-1;n=i[t]??i[i.length-1];break}}n?.focus()};return(0,k.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},e),children:s.map(({value:e,label:n,attributes:r})=>(0,k.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{i.push(e)},onKeyDown:d,onClick:c,...r,className:(0,a.A)("tabs__item",b,r?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function j({lazy:e,children:n,selectedValue:t}){const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=s.find(e=>e.props.value===t);return e?(0,r.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,k.jsx)("div",{className:"margin-top--md",children:s.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function y(e){const n=g(e);return(0,k.jsxs)("div",{className:(0,a.A)(s.G.tabs.container,"tabs-container",x),children:[(0,k.jsx)(w,{...n,...e}),(0,k.jsx)(j,{...n,...e})]})}function D(e){const n=(0,v.A)();return(0,k.jsx)(y,{...e,children:h(e.children)},String(n))}},7105(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>m,frontMatter:()=>l,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"installing/docker_compose-mdns","title":"Docker Compose with mDNS","description":"How to use mDNS enabled image in Docker for your FDM-Monster environment","source":"@site/docs/installing/docker_compose-mdns.mdx","sourceDirName":"installing","slug":"/installing/docker_compose_mdns","permalink":"/docs/installing/docker_compose_mdns","draft":false,"unlisted":false,"editUrl":"https://github.com/fdm-monster/fdm-monster-docs/edit/main/docs/installing/docker_compose-mdns.mdx","tags":[],"version":"current","lastUpdatedBy":"davidzwa","lastUpdatedAt":1768512220000,"frontMatter":{"title":"Docker Compose with mDNS","description":"How to use mDNS enabled image in Docker for your FDM-Monster environment","slug":"/installing/docker_compose_mdns","pagination_prev":"installing/index","pagination_next":"software_usage/index"},"sidebar":"docs","previous":{"title":"Installing","permalink":"/docs/installing"},"next":{"title":"Software Usage","permalink":"/docs/software_usage"}}');var a=t(4848),s=t(8453),o=t(1470),i=t(9365);const l={title:"Docker Compose with mDNS",description:"How to use mDNS enabled image in Docker for your FDM-Monster environment",slug:"/installing/docker_compose_mdns",pagination_prev:"installing/index",pagination_next:"software_usage/index"},c=void 0,d={},u=[{value:"Quick Start",id:"quick-start",level:2},{value:"Changes needed in docker-config.yml",id:"changes-needed-in-docker-configyml",level:2},{value:"Image tags",id:"image-tags",level:3},{value:"Network defintion",id:"network-defintion",level:3},{value:"Static IP vs DHCP",id:"static-ip-vs-dhcp",level:3},{value:"No port definition",id:"no-port-definition",level:3}];function h(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["FDM Monster provides container images with mDNS support, which requires the use of the Docker ",(0,a.jsx)(n.code,{children:"macvlan"})," network driver. As a result, this functionality is limited to hosts running a Linux operating system."]}),"\n",(0,a.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,a.jsx)(n.p,{children:"Before setting up FDM Monster with mDNS you will need the following information."}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"A name for the Docker network to create (you can use an existing macvlan network)."}),"\n",(0,a.jsx)(n.li,{children:"The device label to bind the macvlan network to. For multi-homed systems ensure the device is on the network which will host FDM Monster."}),"\n",(0,a.jsx)(n.li,{children:"The network address in CIDR notation that the macvlan network will be part of (should match the network of the device)."}),"\n",(0,a.jsx)(n.li,{children:"The network range in CIDR notation that specifies IP addresses available to containers attached to the macvlan network."}),"\n",(0,a.jsx)(n.li,{children:"The default gateway of the host interface."}),"\n",(0,a.jsx)(n.li,{children:"The IP address to assign to the container."}),"\n"]}),"\n",(0,a.jsxs)(o.A,{children:[(0,a.jsxs)(i.A,{value:"helper-script",label:"Using a helper script",default:!0,children:[(0,a.jsxs)(n.p,{children:["Our setup script can create the required macvlan network and a functional docker-compose.yml.\nDownload the FDM Monster helper script here: ",(0,a.jsx)(n.a,{href:"https://raw.githubusercontent.com/fdm-monster/fdm-monster-scripts/main/install/linux/macvlan-setup.sh",children:"macvlan-setup.sh"})]}),(0,a.jsx)(n.p,{children:"Execute the script and respond to the prompts."}),(0,a.jsx)(n.p,{children:"Run the container"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"docker compose -f FDMM-mDNS-docker-compose.yml up -d\n"})}),(0,a.jsxs)(n.p,{children:["Use your favorite browser to access ",(0,a.jsx)(n.a,{href:"http://fdmmonster.local",children:"http://fdmmonster.local"})]})]}),(0,a.jsxs)(i.A,{value:"the-hard-way",label:"The Hard Way",children:[(0,a.jsx)(n.p,{children:'"The Hard Way" assumes an understanding of linux and docker.'}),(0,a.jsx)(n.p,{children:"The following is a general guide based on the helper script. Please refer to docker command documentation and FDM Monster source for full descriptions of all syntax and options. In the examples below variable are denoted by ${..}. Please replace the entire variable syntax with correct values for your installation."}),(0,a.jsx)(n.p,{children:"Create the macvlan bridge with these parameters:"}),(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"network"})," like ",(0,a.jsx)(n.code,{children:"192.168.50.0/24"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"subnet"})," like ",(0,a.jsx)(n.code,{children:"192.168.50.128/25"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"gateway"})," like ",(0,a.jsx)(n.code,{children:"192.168.50.1"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"interface"})," like ",(0,a.jsx)(n.code,{children:"eth0"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"name"})," like ",(0,a.jsx)(n.code,{children:"printer_macvlan_net"})]}),"\n"]}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"docker network create -d macvlan --subnet=${network} --ip-range=${subnet} --gateway=${gateway} -o parent=${interface} ${name}\n"})}),(0,a.jsx)(n.p,{children:"Example of a fictive scenario:"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"  docker network create -d macvlan \\\n  --subnet=192.168.50.0/24 \\\n  --ip-range=192.168.50.128/25 \\\n  --gateway=192.168.50.1 \\\n  -o parent=eth0 \\\n  printer_macvlan_net\n"})}),(0,a.jsx)(n.p,{children:"Create a docker-compose.yml similar to this template (replace ${name}, ${ip} on the right places):"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"# This section requires an explicit docker network that allows the container to\n#  utilize an IP directly on the host interface. Reference macvlan setup at\n#  https://docs.docker.com/engine/network/drivers/macvlan/ for details\nservice:\n  fdm-monster-mdns:\n    container_name: fdm-monster-mdns\n    image: fdmmonster/fdm-monster:latest-mdns\n    restart: unless-stopped\n    environment:\n      - SERVER_PORT=80   # Port for FDM Monster\n    deploy:\n      restart_policy:\n        delay: 5s\n        window: 120s\n    networks:\n      ${name}:               # rename to mach your config option below\n        ipv4_address: ${ip}  # IP address to assign to FDM Monster container\n    volumes:\n      - fdmm-media:/app/media\n      - fdmm-database:/app/database\n\nvolumes:\n  fdmm-media:\n    name: fdmm-media\n  fdmm-database:\n    name: fdmm-database\n\nnetworks:\n  ${name}:          # edit to suite as this is internal config\n    external: true\n    name: ${name}   # must match your macvlan bridge name\n"})}),(0,a.jsx)(n.p,{children:"Run the container"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"docker compose -f docker-compose.yml up -d\n"})})]})]}),"\n",(0,a.jsx)(n.h2,{id:"changes-needed-in-docker-configyml",children:"Changes needed in docker-config.yml"}),"\n",(0,a.jsx)(n.p,{children:"The mDNS version requires use of docker's macvlan diver and minor changes to docker-compose.yml. Below are the important notes on these changes."}),"\n",(0,a.jsx)(n.h3,{id:"image-tags",children:"Image tags"}),"\n",(0,a.jsx)(n.p,{children:'mDNS support is available via a new image. This image can be selected by adding "-mdns" to any of the standard FMD Monster tags.'}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"latest-mdns"}),"\n",(0,a.jsx)(n.li,{children:"x.y.z-mdns"}),"\n",(0,a.jsx)(n.li,{children:"main-mdns"}),"\n",(0,a.jsx)(n.li,{children:"develop-mdns"}),"\n",(0,a.jsx)(n.li,{children:"x.y.z-rc1-1234-mdns"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"network-defintion",children:"Network defintion"}),"\n",(0,a.jsxs)(n.p,{children:["Within the docker-compose.yml, you must create a network definition. The defintion label does not need to match the macvlan network name. It is simply easier, and not harmful to use the same name. The name statement ",(0,a.jsx)(n.strong,{children:"must"})," match the macvlan bridge name."]}),"\n",(0,a.jsx)(n.h3,{id:"static-ip-vs-dhcp",children:"Static IP vs DHCP"}),"\n",(0,a.jsxs)(n.p,{children:["The FDM Monster container image does not support DHCP address assignment. If a static IP is not explicitly assigned, Docker will automatically select the next available IP address from the bridge network\u2019s configured range. It is strongly recommended to either assign a static IP address to the container ",(0,a.jsx)(n.strong,{children:"or"})," configure a hostname to enable mDNS-based name resolution."]}),"\n",(0,a.jsx)(n.p,{children:"It is also highly recommended that the IP range provided to the mavlan bridge be removed from any DHCP scopes to prevent duplicate IP address use on your network."}),"\n",(0,a.jsx)(n.h3,{id:"no-port-definition",children:"No port definition"}),"\n",(0,a.jsx)(n.p,{children:"No port definition is used in the mDNS docker-compose.yml. There are 2 reasons for this:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:'The container "lives" on the host\'s native network with a unique, network accessible MAC address and IP. This means that all open ports on the container are accessible on the network.'}),"\n",(0,a.jsx)(n.li,{children:"Port mapping is not supported by the macvlan driver."}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},8453(e,n,t){t.d(n,{R:()=>o,x:()=>i});var r=t(6540);const a={},s=r.createContext(a);function o(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),r.createElement(s.Provider,{value:n},e.children)}},9365(e,n,t){t.d(n,{A:()=>o});t(6540);var r=t(4164);const a="tabItem_Ymn6";var s=t(4848);function o({children:e,hidden:n,className:t}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(a,t),hidden:n,children:e})}}}]);